# 用户配置文件结构

## 概述
为了让用户能够方便地修改所有配置文件，我们采用以下策略：
1. 应用内置默认配置文件（只读）
2. 用户配置文件目录（可写）
3. 用户配置优先于默认配置

## 目录结构

### 应用内置配置（只读）
```
应用包内/
├── config/
│   ├── colorspace/          # 色彩空间定义
│   ├── curves/             # 曲线预设
│   ├── matrices/           # 校正矩阵
│   └── app_settings.json   # 应用设置
```

### 用户配置目录（可写）
```
用户目录/
├── DiVERE/
│   ├── config/
│   │   ├── colorspace/     # 用户自定义色彩空间
│   │   ├── curves/         # 用户自定义曲线
│   │   ├── matrices/       # 用户自定义矩阵
│   │   └── app_settings.json
│   ├── models/             # 用户自定义模型
│   └── logs/               # 日志文件
```

## 配置文件优先级
1. 用户配置文件（最高优先级）
2. 应用内置配置文件（默认值）

## 配置文件类型

### 1. 色彩空间配置 (colorspace/*.json)
- 定义色彩空间的色域、白点等参数
- 用户可添加自定义色彩空间
- 文件名作为色彩空间名称

### 2. 曲线配置 (curves/*.json)
- 密度打印曲线预设
- 支持RGB、R、G、B四个通道
- 用户可创建自定义曲线

### 3. 校正矩阵配置 (matrices/*.json)
- 色彩校正矩阵
- 用于特定胶片类型的校正
- 用户可添加自定义矩阵

### 4. 应用设置 (app_settings.json)
- 界面设置（窗口大小、位置等）
- 目录记忆功能
- 默认参数设置

## 用户操作指南

### 添加自定义色彩空间
1. 在用户配置目录创建 `config/colorspace/` 文件夹
2. 添加 `.json` 文件，格式参考内置配置
3. 重启应用，新色彩空间将出现在选择列表中

### 添加自定义曲线
1. 在用户配置目录创建 `config/curves/` 文件夹
2. 添加 `.json` 文件，格式参考内置配置
3. 重启应用，新曲线将出现在预设列表中

### 添加自定义矩阵
1. 在用户配置目录创建 `config/matrices/` 文件夹
2. 添加 `.json` 文件，格式参考内置配置
3. 重启应用，新矩阵将出现在选择列表中

### 修改应用设置
1. 直接编辑用户配置目录中的 `app_settings.json`
2. 或通过应用界面修改，自动保存到用户配置

## 配置文件格式示例

### 色彩空间配置
```json
{
  "name": "自定义色彩空间",
  "description": "用户自定义的色彩空间",
  "primaries": {
    "R": [0.64, 0.33],
    "G": [0.30, 0.60],
    "B": [0.15, 0.06]
  },
  "white_point": [0.3127, 0.3290],
  "gamma": 2.2
}
```

### 曲线配置
```json
{
  "name": "自定义曲线",
  "description": "用户自定义的密度打印曲线",
  "curves": {
    "RGB": [[0.0, 0.0], [0.5, 0.3], [1.0, 1.0]],
    "R": [[0.0, 0.0], [1.0, 1.0]],
    "G": [[0.0, 0.0], [1.0, 1.0]],
    "B": [[0.0, 0.0], [1.0, 1.0]]
  }
}
```

### 校正矩阵配置
```json
{
  "name": "自定义矩阵",
  "description": "用户自定义的校正矩阵",
  "matrix": [
    [1.1, 0.0, 0.0],
    [0.0, 1.0, 0.0],
    [0.0, 0.0, 0.9]
  ]
}
```
